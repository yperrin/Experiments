<nav>
  <mat-toolbar [color]="selectionCount > 0 ? '' : 'primary'">
    <span class="toolbar-item">
        <mat-icon class="mat-icon material-icons" role="img">playlist_add_check</mat-icon>&nbsp;
        EXCIT Inventory
    </span>
    <span [hidden]="selectionCount > 0" class="toolbar-item blank"><mat-icon class="mat-icon material-icons" role="img" (click)="searchWrapperClicked($event)">search</mat-icon></span>
    <span [hidden]="selectionCount > 0" class="toolbar-item search" (click)="searchWrapperClicked($event)">
      <input #searchBox value="" placeholder="Search" (keyup)="search(searchBox.value)">
    </span>
    <span  [hidden]="selectionCount == 0" class="toolbar-item menu">
        <button mat-icon-button color="primary" title="Run Report"><mat-icon class="mat-icon material-icons" role="img">play_arrow</mat-icon></button>
        Run the report for the {{selectionCount}} selected supplier(s)
    </span>
  </mat-toolbar>
</nav>
<mat-card>
  <mat-card-content>
    <mat-table #table [dataSource]="supplierDatasource" matSort  (matSortChange)="sortData($event)">
        <ng-container matColumnDef="name">
              <mat-header-cell *matHeaderCellDef mat-sort-header> Name </mat-header-cell>
              <mat-cell *matCellDef="let row" class="header" title="{{row.Identifier}}">
                <mat-checkbox [(ngModel)]="row.selected" color="primary" (ngModelChange)="selectionChanged()">{{row.name}}</mat-checkbox>
              </mat-cell>
        </ng-container>
        <ng-container matColumnDef="asiNumber">
          <mat-header-cell *matHeaderCellDef  mat-sort-header> ASI# </mat-header-cell>
          <mat-cell *matCellDef="let row"> {{row.asiNumber}} </mat-cell>
        </ng-container>
        <ng-container matColumnDef="lastRun">
          <mat-header-cell *matHeaderCellDef mat-sort-header> Last Run </mat-header-cell>
          <mat-cell *matCellDef="let row">
            <span *ngIf="!row.active" [class]="row.successRate >= 90 ? 'report-passed' : 'report-failed'">{{row.lastRun | date }}</span>
            <span *ngIf="row.active" class="menu-active">
              <span class="report">Last run on&nbsp;<em>{{row.lastRun | date }}</em> with success rate of <em>{{row.successRate}}%</em></span>
              <span>
                  <button mat-icon-button color="primary" title="View Report" (click)="openReport(row)"><mat-icon class="mat-icon material-icons" role="img">description</mat-icon></button>
                  <button mat-icon-button color="primary" title="Run Report"><mat-icon class="mat-icon material-icons" role="img">play_arrow</mat-icon></button>
              </span>
            </span>
          </mat-cell>
        </ng-container>
        <mat-header-row *matHeaderRowDef="['name', 'asiNumber', 'lastRun']"></mat-header-row>
        <mat-row *matRowDef="let row; columns: ['name', 'asiNumber', 'lastRun'];"
          [ngClass]="row.active ? 'active' : ''"
          (mouseenter)="hovered(row, true)" (mouseleave)="hovered(row, false)">
        </mat-row>
      </mat-table>
  </mat-card-content>
</mat-card>
